<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Event Task Matrix (ETM)"><title>esp_hal::etm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="esp_hal" data-themes="" data-resource-suffix="" data-rustdoc-version="1.78.0-nightly (878c8a2a6 2024-02-29)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-4c98445ec4002617.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-12cf3b4f4f9dc36d.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../esp_hal/index.html"><img src="https://avatars.githubusercontent.com/u/46717278" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../esp_hal/index.html"><img src="https://avatars.githubusercontent.com/u/46717278" alt="logo"></a><h2><a href="../../esp_hal/index.html">esp_hal</a><span class="version">0.15.0</span></h2></div><h2 class="location"><a href="#">Module etm</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section><h2><a href="../index.html">In crate esp_hal</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../esp_hal/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">esp_hal</a>::<wbr><a class="mod" href="#">etm</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/esp_hal/etm.rs.html#1-278">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="event-task-matrix-etm"><a class="doc-anchor" href="#event-task-matrix-etm">§</a>Event Task Matrix (ETM)</h2><h3 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h3>
<p>Normally, if a peripheral X needs to notify peripheral Y of a particular
event, this could only be done via a CPU interrupt from peripheral X, where
the CPU notifies peripheral Y on behalf of peripheral X. However, in
time-critical applications, the latency introduced by CPU interrupts is
non-negligible.</p>
<p>With the help of the Event Task Matrix (ETM) module, some peripherals can
directly notify other peripherals of events through pre-set connections
without the intervention of CPU interrupts. This allows precise and low
latency synchronization between peripherals, and lessens the CPU’s workload
as the CPU no longer needs to handle these events.</p>
<p>The ETM module has multiple programmable channels, they are used to connect
a particular Event to a particular Task. When an event is activated, the ETM
channel will trigger the corresponding task automatically.</p>
<p>More information: https://docs.espressif.com/projects/esp-idf/en/latest/esp32c6/api-reference/peripherals/etm.html</p>
<h3 id="example"><a class="doc-anchor" href="#example">§</a>Example</h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>io = IO::new(peripherals.GPIO, peripherals.IO_MUX);
<span class="kw">let </span><span class="kw-2">mut </span>led = io.pins.gpio1.into_push_pull_output();
<span class="kw">let </span>button = io.pins.gpio9.into_pull_down_input();

<span class="comment">// setup ETM
</span><span class="kw">let </span>gpio_ext = GpioEtmChannels::new(peripherals.GPIO_SD);
<span class="kw">let </span>led_task = gpio_ext.channel0_task.toggle(<span class="kw-2">&amp;mut </span>led);
<span class="kw">let </span>button_event = gpio_ext.channel0_event.falling_edge(button);

<span class="kw">let </span>etm = Etm::new(peripherals.SOC_ETM);
<span class="kw">let </span>channel0 = etm.channel0;

<span class="comment">// make sure the configured channel doesn't get dropped - dropping it will
// disable the channel
</span><span class="kw">let </span>_configured_channel = channel0.setup(<span class="kw-2">&amp;</span>button_event, <span class="kw-2">&amp;</span>led_task);

<span class="comment">// the LED is controlled by the button without involving the CPU
</span><span class="kw">loop </span>{}</code></pre></div>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Etm.html" title="struct esp_hal::etm::Etm">Etm</a></div><div class="desc docblock-short">ETM Instance</div></li><li><div class="item-name"><a class="struct" href="struct.EtmChannel.html" title="struct esp_hal::etm::EtmChannel">EtmChannel</a></div><div class="desc docblock-short">Unconfigured EtmChannel.</div></li><li><div class="item-name"><a class="struct" href="struct.EtmConfiguredChannel.html" title="struct esp_hal::etm::EtmConfiguredChannel">EtmConfiguredChannel</a></div><div class="desc docblock-short">A readily configured channel</div></li></ul></section></div></main></body></html>