<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Command and boot configuration register"><title>esp32p4::sdhost::cmd - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="esp32p4" data-themes="" data-resource-suffix="" data-rustdoc-version="1.78.0-nightly (d18480b84 2024-03-04)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-4c98445ec4002617.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-12cf3b4f4f9dc36d.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../../esp32p4/index.html"><img src="https://avatars.githubusercontent.com/u/46717278" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../esp32p4/index.html"><img src="https://avatars.githubusercontent.com/u/46717278" alt="logo"></a><h2><a href="../../../esp32p4/index.html">esp32p4</a><span class="version">0.1.0</span></h2></div><h2 class="location"><a href="#">Module cmd</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#types">Type Aliases</a></li></ul></section><h2><a href="../index.html">In esp32p4::sdhost</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../../esp32p4/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">esp32p4</a>::<wbr><a href="../index.html">sdhost</a>::<wbr><a class="mod" href="#">cmd</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/esp32p4/sdhost/cmd.rs.html#1-358">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Command and boot configuration register</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CMD_SPEC.html" title="struct esp32p4::sdhost::cmd::CMD_SPEC">CMD_SPEC</a></div><div class="desc docblock-short">Command and boot configuration register</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.CARD_NUMBER_R.html" title="type esp32p4::sdhost::cmd::CARD_NUMBER_R">CARD_NUMBER_R</a></div><div class="desc docblock-short">Field <code>CARD_NUMBER</code> reader - Card number in use. Represents physical slot number of card being accessed. In SD-only mode, up to two cards are supported.</div></li><li><div class="item-name"><a class="type" href="type.CARD_NUMBER_W.html" title="type esp32p4::sdhost::cmd::CARD_NUMBER_W">CARD_NUMBER_W</a></div><div class="desc docblock-short">Field <code>CARD_NUMBER</code> writer - Card number in use. Represents physical slot number of card being accessed. In SD-only mode, up to two cards are supported.</div></li><li><div class="item-name"><a class="type" href="type.CCS_EXPECTED_R.html" title="type esp32p4::sdhost::cmd::CCS_EXPECTED_R">CCS_EXPECTED_R</a></div><div class="desc docblock-short">Field <code>CCS_EXPECTED</code> reader - Expected Command Completion Signal (CCS) configuration. 0: Interrupts are not enabled in CE-ATA device (nIEN = 1 in ATA control register), or command does not expect CCS from device; 1: Interrupts are enabled in CE-ATA device (nIEN = 0), and RW_BLK command expects command completion signal from CE-ATA device. If the command expects Command Completion Signal (CCS) from the CE-ATA device, the software should set this control bit. SD/MMC sets Data Transfer Over (DTO) bit in RINTSTS register and generates interrupt to host if Data Transfer Over interrupt is not masked.</div></li><li><div class="item-name"><a class="type" href="type.CCS_EXPECTED_W.html" title="type esp32p4::sdhost::cmd::CCS_EXPECTED_W">CCS_EXPECTED_W</a></div><div class="desc docblock-short">Field <code>CCS_EXPECTED</code> writer - Expected Command Completion Signal (CCS) configuration. 0: Interrupts are not enabled in CE-ATA device (nIEN = 1 in ATA control register), or command does not expect CCS from device; 1: Interrupts are enabled in CE-ATA device (nIEN = 0), and RW_BLK command expects command completion signal from CE-ATA device. If the command expects Command Completion Signal (CCS) from the CE-ATA device, the software should set this control bit. SD/MMC sets Data Transfer Over (DTO) bit in RINTSTS register and generates interrupt to host if Data Transfer Over interrupt is not masked.</div></li><li><div class="item-name"><a class="type" href="type.CHECK_RESPONSE_CRC_R.html" title="type esp32p4::sdhost::cmd::CHECK_RESPONSE_CRC_R">CHECK_RESPONSE_CRC_R</a></div><div class="desc docblock-short">Field <code>CHECK_RESPONSE_CRC</code> reader - 0: Do not check; 1: Check response CRC. Some of command responses do not return valid CRC bits. Software should disable CRC checks for those commands in order to disable CRC checking by controller.</div></li><li><div class="item-name"><a class="type" href="type.CHECK_RESPONSE_CRC_W.html" title="type esp32p4::sdhost::cmd::CHECK_RESPONSE_CRC_W">CHECK_RESPONSE_CRC_W</a></div><div class="desc docblock-short">Field <code>CHECK_RESPONSE_CRC</code> writer - 0: Do not check; 1: Check response CRC. Some of command responses do not return valid CRC bits. Software should disable CRC checks for those commands in order to disable CRC checking by controller.</div></li><li><div class="item-name"><a class="type" href="type.DATA_EXPECTED_R.html" title="type esp32p4::sdhost::cmd::DATA_EXPECTED_R">DATA_EXPECTED_R</a></div><div class="desc docblock-short">Field <code>DATA_EXPECTED</code> reader - 0: No data transfer expected; 1: Data transfer expected.</div></li><li><div class="item-name"><a class="type" href="type.DATA_EXPECTED_W.html" title="type esp32p4::sdhost::cmd::DATA_EXPECTED_W">DATA_EXPECTED_W</a></div><div class="desc docblock-short">Field <code>DATA_EXPECTED</code> writer - 0: No data transfer expected; 1: Data transfer expected.</div></li><li><div class="item-name"><a class="type" href="type.INDEX_R.html" title="type esp32p4::sdhost::cmd::INDEX_R">INDEX_R</a></div><div class="desc docblock-short">Field <code>INDEX</code> reader - Command index.</div></li><li><div class="item-name"><a class="type" href="type.INDEX_W.html" title="type esp32p4::sdhost::cmd::INDEX_W">INDEX_W</a></div><div class="desc docblock-short">Field <code>INDEX</code> writer - Command index.</div></li><li><div class="item-name"><a class="type" href="type.R.html" title="type esp32p4::sdhost::cmd::R">R</a></div><div class="desc docblock-short">Register <code>CMD</code> reader</div></li><li><div class="item-name"><a class="type" href="type.READ_CEATA_DEVICE_R.html" title="type esp32p4::sdhost::cmd::READ_CEATA_DEVICE_R">READ_CEATA_DEVICE_R</a></div><div class="desc docblock-short">Field <code>READ_CEATA_DEVICE</code> reader - Read access flag. 0: Host is not performing read access (RW_REG or RW_BLK)towards CE-ATA device; 1: Host is performing read access (RW_REG or RW_BLK) towards CE-ATA device. Software should set this bit to indicate that CE-ATA device is being accessed for read transfer. This bit is used to disable read data timeout indication while performing CE-ATA read transfers. Maximum value of I/O transmission delay can be no less than 10 seconds. SD/MMC should not indicate read data timeout while waiting for data from CE-ATA device.</div></li><li><div class="item-name"><a class="type" href="type.READ_CEATA_DEVICE_W.html" title="type esp32p4::sdhost::cmd::READ_CEATA_DEVICE_W">READ_CEATA_DEVICE_W</a></div><div class="desc docblock-short">Field <code>READ_CEATA_DEVICE</code> writer - Read access flag. 0: Host is not performing read access (RW_REG or RW_BLK)towards CE-ATA device; 1: Host is performing read access (RW_REG or RW_BLK) towards CE-ATA device. Software should set this bit to indicate that CE-ATA device is being accessed for read transfer. This bit is used to disable read data timeout indication while performing CE-ATA read transfers. Maximum value of I/O transmission delay can be no less than 10 seconds. SD/MMC should not indicate read data timeout while waiting for data from CE-ATA device.</div></li><li><div class="item-name"><a class="type" href="type.READ_WRITE_R.html" title="type esp32p4::sdhost::cmd::READ_WRITE_R">READ_WRITE_R</a></div><div class="desc docblock-short">Field <code>READ_WRITE</code> reader - 0: Read from card; 1: Write to card. Don’t care if no data is expected from card.</div></li><li><div class="item-name"><a class="type" href="type.READ_WRITE_W.html" title="type esp32p4::sdhost::cmd::READ_WRITE_W">READ_WRITE_W</a></div><div class="desc docblock-short">Field <code>READ_WRITE</code> writer - 0: Read from card; 1: Write to card. Don’t care if no data is expected from card.</div></li><li><div class="item-name"><a class="type" href="type.RESPONSE_EXPECT_R.html" title="type esp32p4::sdhost::cmd::RESPONSE_EXPECT_R">RESPONSE_EXPECT_R</a></div><div class="desc docblock-short">Field <code>RESPONSE_EXPECT</code> reader - 0: No response expected from card; 1: Response expected from card.</div></li><li><div class="item-name"><a class="type" href="type.RESPONSE_EXPECT_W.html" title="type esp32p4::sdhost::cmd::RESPONSE_EXPECT_W">RESPONSE_EXPECT_W</a></div><div class="desc docblock-short">Field <code>RESPONSE_EXPECT</code> writer - 0: No response expected from card; 1: Response expected from card.</div></li><li><div class="item-name"><a class="type" href="type.RESPONSE_LENGTH_R.html" title="type esp32p4::sdhost::cmd::RESPONSE_LENGTH_R">RESPONSE_LENGTH_R</a></div><div class="desc docblock-short">Field <code>RESPONSE_LENGTH</code> reader - 0: Short response expected from card; 1: Long response expected from card.</div></li><li><div class="item-name"><a class="type" href="type.RESPONSE_LENGTH_W.html" title="type esp32p4::sdhost::cmd::RESPONSE_LENGTH_W">RESPONSE_LENGTH_W</a></div><div class="desc docblock-short">Field <code>RESPONSE_LENGTH</code> writer - 0: Short response expected from card; 1: Long response expected from card.</div></li><li><div class="item-name"><a class="type" href="type.SEND_AUTO_STOP_R.html" title="type esp32p4::sdhost::cmd::SEND_AUTO_STOP_R">SEND_AUTO_STOP_R</a></div><div class="desc docblock-short">Field <code>SEND_AUTO_STOP</code> reader - 0: No stop command is sent at the end of data transfer; 1: Send stop command at the end of data transfer.</div></li><li><div class="item-name"><a class="type" href="type.SEND_AUTO_STOP_W.html" title="type esp32p4::sdhost::cmd::SEND_AUTO_STOP_W">SEND_AUTO_STOP_W</a></div><div class="desc docblock-short">Field <code>SEND_AUTO_STOP</code> writer - 0: No stop command is sent at the end of data transfer; 1: Send stop command at the end of data transfer.</div></li><li><div class="item-name"><a class="type" href="type.SEND_INITIALIZATION_R.html" title="type esp32p4::sdhost::cmd::SEND_INITIALIZATION_R">SEND_INITIALIZATION_R</a></div><div class="desc docblock-short">Field <code>SEND_INITIALIZATION</code> reader - 0: Do not send initialization sequence (80 clocks of 1) before sending this command; 1: Send initialization sequence before sending this command. After powered on, 80 clocks must be sent to card for initialization before sending any commands to card. Bit should be set while sending first command to card so that controller will initialize clocks before sending command to card.</div></li><li><div class="item-name"><a class="type" href="type.SEND_INITIALIZATION_W.html" title="type esp32p4::sdhost::cmd::SEND_INITIALIZATION_W">SEND_INITIALIZATION_W</a></div><div class="desc docblock-short">Field <code>SEND_INITIALIZATION</code> writer - 0: Do not send initialization sequence (80 clocks of 1) before sending this command; 1: Send initialization sequence before sending this command. After powered on, 80 clocks must be sent to card for initialization before sending any commands to card. Bit should be set while sending first command to card so that controller will initialize clocks before sending command to card.</div></li><li><div class="item-name"><a class="type" href="type.START_CMD_R.html" title="type esp32p4::sdhost::cmd::START_CMD_R">START_CMD_R</a></div><div class="desc docblock-short">Field <code>START_CMD</code> reader - Start command. Once command is served by the CIU, this bit is automatically cleared. When this bit is set, host should not attempt to write to any command registers. If a write is attempted, hardware lock error is set in raw interrupt register. Once command is sent and a response is received from SD_MMC_CEATA cards, Command Done bit is set in the raw interrupt Register.</div></li><li><div class="item-name"><a class="type" href="type.START_CMD_W.html" title="type esp32p4::sdhost::cmd::START_CMD_W">START_CMD_W</a></div><div class="desc docblock-short">Field <code>START_CMD</code> writer - Start command. Once command is served by the CIU, this bit is automatically cleared. When this bit is set, host should not attempt to write to any command registers. If a write is attempted, hardware lock error is set in raw interrupt register. Once command is sent and a response is received from SD_MMC_CEATA cards, Command Done bit is set in the raw interrupt Register.</div></li><li><div class="item-name"><a class="type" href="type.STOP_ABORT_CMD_R.html" title="type esp32p4::sdhost::cmd::STOP_ABORT_CMD_R">STOP_ABORT_CMD_R</a></div><div class="desc docblock-short">Field <code>STOP_ABORT_CMD</code> reader - 0: Neither stop nor abort command can stop current data transfer. If abort is sent to function-number currently selected or not in data-transfer mode, then bit should be set to 0; 1: Stop or abort command intended to stop current data transfer in progress. When open-ended or predefined data transfer is in progress, and host issues stop or abort command to stop data transfer, bit should be set so that command/data state-machines of CIU can return correctly to idle state.</div></li><li><div class="item-name"><a class="type" href="type.STOP_ABORT_CMD_W.html" title="type esp32p4::sdhost::cmd::STOP_ABORT_CMD_W">STOP_ABORT_CMD_W</a></div><div class="desc docblock-short">Field <code>STOP_ABORT_CMD</code> writer - 0: Neither stop nor abort command can stop current data transfer. If abort is sent to function-number currently selected or not in data-transfer mode, then bit should be set to 0; 1: Stop or abort command intended to stop current data transfer in progress. When open-ended or predefined data transfer is in progress, and host issues stop or abort command to stop data transfer, bit should be set so that command/data state-machines of CIU can return correctly to idle state.</div></li><li><div class="item-name"><a class="type" href="type.TRANSFER_MODE_R.html" title="type esp32p4::sdhost::cmd::TRANSFER_MODE_R">TRANSFER_MODE_R</a></div><div class="desc docblock-short">Field <code>TRANSFER_MODE</code> reader - 0: Block data transfer command; 1: Stream data transfer command. Don’t care if no data expected.</div></li><li><div class="item-name"><a class="type" href="type.TRANSFER_MODE_W.html" title="type esp32p4::sdhost::cmd::TRANSFER_MODE_W">TRANSFER_MODE_W</a></div><div class="desc docblock-short">Field <code>TRANSFER_MODE</code> writer - 0: Block data transfer command; 1: Stream data transfer command. Don’t care if no data expected.</div></li><li><div class="item-name"><a class="type" href="type.UPDATE_CLOCK_REGISTERS_ONLY_R.html" title="type esp32p4::sdhost::cmd::UPDATE_CLOCK_REGISTERS_ONLY_R">UPDATE_CLOCK_REGISTERS_ONLY_R</a></div><div class="desc docblock-short">Field <code>UPDATE_CLOCK_REGISTERS_ONLY</code> reader - 0: Normal command sequence; 1: Do not send commands, just update clock register value into card clock domain. Following register values are transferred into card clock domain: CLKDIV, CLRSRC, and CLKENA. Changes card clocks (change frequency, truncate off or on, and set low-frequency mode). This is provided in order to change clock frequency or stop clock without having to send command to cards. During normal command sequence, when sdhost_update_clock_registers_only = 0, following control registers are transferred from BIU to CIU: CMD, CMDARG, TMOUT, CTYPE, BLKSIZ, and BYTCNT. CIU uses new register values for new command sequence to card(s). When bit is set, there are no Command Done interrupts because no command is sent to SD_MMC_CEATA cards.</div></li><li><div class="item-name"><a class="type" href="type.UPDATE_CLOCK_REGISTERS_ONLY_W.html" title="type esp32p4::sdhost::cmd::UPDATE_CLOCK_REGISTERS_ONLY_W">UPDATE_CLOCK_REGISTERS_ONLY_W</a></div><div class="desc docblock-short">Field <code>UPDATE_CLOCK_REGISTERS_ONLY</code> writer - 0: Normal command sequence; 1: Do not send commands, just update clock register value into card clock domain. Following register values are transferred into card clock domain: CLKDIV, CLRSRC, and CLKENA. Changes card clocks (change frequency, truncate off or on, and set low-frequency mode). This is provided in order to change clock frequency or stop clock without having to send command to cards. During normal command sequence, when sdhost_update_clock_registers_only = 0, following control registers are transferred from BIU to CIU: CMD, CMDARG, TMOUT, CTYPE, BLKSIZ, and BYTCNT. CIU uses new register values for new command sequence to card(s). When bit is set, there are no Command Done interrupts because no command is sent to SD_MMC_CEATA cards.</div></li><li><div class="item-name"><a class="type" href="type.USE_HOLE_R.html" title="type esp32p4::sdhost::cmd::USE_HOLE_R">USE_HOLE_R</a></div><div class="desc docblock-short">Field <code>USE_HOLE</code> reader - Use Hold Register. 0: CMD and DATA sent to card bypassing HOLD Register; 1: CMD and DATA sent to card through the HOLD Register.</div></li><li><div class="item-name"><a class="type" href="type.USE_HOLE_W.html" title="type esp32p4::sdhost::cmd::USE_HOLE_W">USE_HOLE_W</a></div><div class="desc docblock-short">Field <code>USE_HOLE</code> writer - Use Hold Register. 0: CMD and DATA sent to card bypassing HOLD Register; 1: CMD and DATA sent to card through the HOLD Register.</div></li><li><div class="item-name"><a class="type" href="type.W.html" title="type esp32p4::sdhost::cmd::W">W</a></div><div class="desc docblock-short">Register <code>CMD</code> writer</div></li><li><div class="item-name"><a class="type" href="type.WAIT_PRVDATA_COMPLETE_R.html" title="type esp32p4::sdhost::cmd::WAIT_PRVDATA_COMPLETE_R">WAIT_PRVDATA_COMPLETE_R</a></div><div class="desc docblock-short">Field <code>WAIT_PRVDATA_COMPLETE</code> reader - 0: Send command at once, even if previous data transfer has not completed; 1: Wait for previous data transfer to complete before sending Command. The SDHOST_WAIT_PRVDATA_COMPLETE] = 0 option is typically used to query status of card during data transfer or to stop current data transfer. SDHOST_CARD_NUMBERr should be same as in previous command.</div></li><li><div class="item-name"><a class="type" href="type.WAIT_PRVDATA_COMPLETE_W.html" title="type esp32p4::sdhost::cmd::WAIT_PRVDATA_COMPLETE_W">WAIT_PRVDATA_COMPLETE_W</a></div><div class="desc docblock-short">Field <code>WAIT_PRVDATA_COMPLETE</code> writer - 0: Send command at once, even if previous data transfer has not completed; 1: Wait for previous data transfer to complete before sending Command. The SDHOST_WAIT_PRVDATA_COMPLETE] = 0 option is typically used to query status of card during data transfer or to stop current data transfer. SDHOST_CARD_NUMBERr should be same as in previous command.</div></li></ul></section></div></main></body></html>